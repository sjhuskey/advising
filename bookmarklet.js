// This bookmarklet exports course data from the advising page as a TSV file.
javascript:(()=>{try{const rows=[...document.querySelectorAll('td.coursesUsedRow table table tr')];const out=[];for(const tr of rows){const tds=tr.querySelectorAll('td');if(tds.length>=3){const num=(tds[0].innerText||'').replace(/\D+/g,'').trim();const course=(tds[1].innerText||'').trim();const par=(tds[2].innerText||'').replace(/\s+/g,' ').trim();if(num&&course&&/\(.*\)/.test(par)){out.push([num,course,par].join('\t'));}}}if(!out.length){alert('No rows found. Are you on the advising page?');return;}const blob=new Blob([out.join('\n')],{type:'text/tab-separated-values;charset=utf-8'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='advising_export.tsv';document.body.appendChild(a);a.click();setTimeout(()=>URL.revokeObjectURL(a.href),2000);}catch(e){alert('Export failed: '+e)}})();
